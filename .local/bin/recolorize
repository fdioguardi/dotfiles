#!/bin/bash

# Recolorize
# A script to load saved color schemes


# If you have a sccript to change the color of an app
# based on either .Xresources or ~/.cache/paintee
# call it inside this function
function update_apps
{
	# Bspwm
	$HOME/.config/bspwm/color_setup.sh
}


function usage
{
	echo -e "Usage: $( basename $0 ) [-c PATH] [-x PATH] FILE..." >&2
}

# Default path to colors, change it at execution with [-c new_path] or modify permanently the hardcoded value
color_path="$HOME/.Xresources.d/colors"

# Same thing with the .Xresources file, you can use [-x new_path]
xresources_path="$HOME/.Xresources"

while getopts 'lrc:x:' opt; do
	case "$opt" in
		l)
			for color in $color_path/*; do
				echo $(basename $color)
			done
			exit 0
			;;
		r)		#Placebo effect
			;;
		c)
			color_path=$OPTARG
			;;
		x)
			xresources_path=$OPTARG
			;;
		?)
			usage
			exit 2
			;;
	esac
done
shift "$(($OPTIND - 1))"

if [[ $# -gt 1 ]]; then
	usage
	exit 1
elif [[ $# -eq 1 ]]; then
	color_basename=$1
else
	color_basename=$(basename $(shuf -n1 -e $color_path/*))
fi

xrdb $xresources_path 
xrdb -merge "$color_path/$color_basename"

paintee
echo -e "
Current color scheme: '$color_path/$color_basename'
Current Xresources file: '$xresources_path'
Updated: $(date)" >> ~/.cache/paintee

update_apps
